<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css">
    <title>Buscador Digimon</title>
 </head>
<body>
    <h1>Buscador de Digimon</h1>
    <form id="buscador">
        <label for="tipo"><b>Buscar por:</b></label>
        <select id="tipo">
            <option value="todos">Todos</option>
            <option value="nombre">Nombre</option>
            <option value="nivel">Nivel</option>
        </select>
        <input type="text" id="valor">
        <button type="submit">Buscar</button>
    </form>

    <div id="mensaje"></div>

    <table id="tabla" style="display:none;">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Nivel</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        const form = document.getElementById("buscador");
        const tabla = document.getElementById("tabla");
        const cuerpo = tabla.querySelector("tbody");
        const mensaje = document.getElementById("mensaje");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const tipo = document.getElementById("tipo").value;
            const valor = document.getElementById("valor").value.trim().toLowerCase();
            let url = "";

            if (tipo === "todos") {
                url = "https://digimon-api.vercel.app/api/digimon";
            } else if (tipo === "nombre") {
                url = `https://digimon-api.vercel.app/api/digimon/name/${valor}`;
            } else if (tipo === "nivel") {
                url = `https://digimon-api.vercel.app/api/digimon/level/${valor}`;
            }

            mensaje.textContent = "Buscando";
            cuerpo.innerHTML = "";
            tabla.style.display = "none";

            try {
                const res = await fetch(url);
                const data = await res.json();

                if (Array.isArray(data) && data.length > 0) {
                    tabla.style.display = "table";
                    data.forEach(d => {
                        const fila = document.createElement("tr");
                        fila.innerHTML = `
                            <td>${d.name}</td>
                            <td>${d.level}</td>
                        `;
                        cuerpo.appendChild(fila);
                    });
                    mensaje.textContent = `Se encontraron ${data.length} resultados.`;
                } else {
                    mensaje.textContent = "No se encontraron resultados.";
                }
            } catch (error) {
                mensaje.textContent = "Error al conectar con el servidor de la API.";
            }
        });
    </script>

</body>
</html>
